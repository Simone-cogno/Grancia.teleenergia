HTMLArea.InsertSmiley=HTMLArea.Plugin.extend({constructor:function(editor,pluginName){this.base(editor,pluginName);},configurePlugin:function(editor){this.pageTSConfiguration=this.editorConfiguration.buttons.emoticon;this.icons=[{file:HTMLArea.editorUrl+'plugins/InsertSmiley/smileys/'+'mozilla_smile'+'.png',alt:':-)',title:this.localize('mozilla_smile')},{file:HTMLArea.editorUrl+'plugins/InsertSmiley/smileys/'+'mozilla_frown'+'.png',alt:':-(',title:this.localize('mozilla_frown')},{file:HTMLArea.editorUrl+'plugins/InsertSmiley/smileys/'+'mozilla_wink'+'.png',alt:';-)',title:this.localize('mozilla_wink')},{file:HTMLArea.editorUrl+'plugins/InsertSmiley/smileys/'+'mozilla_tongueout'+'.png',alt:':-P',title:this.localize('mozilla_tongueout')},{file:HTMLArea.editorUrl+'plugins/InsertSmiley/smileys/'+'mozilla_laughing'+'.png',alt:':-D',title:this.localize('mozilla_laughing')},{file:HTMLArea.editorUrl+'plugins/InsertSmiley/smileys/'+'mozilla_embarassed'+'.png',alt:':-[',title:this.localize('mozilla_embarassed')},{file:HTMLArea.editorUrl+'plugins/InsertSmiley/smileys/'+'mozilla_undecided'+'.png',alt:':-\\',title:this.localize('mozilla_undecided')},{file:HTMLArea.editorUrl+'plugins/InsertSmiley/smileys/'+'mozilla_surprised'+'.png',alt:'=-O',title:this.localize('mozilla_surprised')},{file:HTMLArea.editorUrl+'plugins/InsertSmiley/smileys/'+'mozilla_kiss'+'.png',alt:':-*',title:this.localize('mozilla_kiss')},{file:HTMLArea.editorUrl+'plugins/InsertSmiley/smileys/'+'mozilla_yell'+'.png',alt:'>:o',title:this.localize('mozilla_yell')},{file:HTMLArea.editorUrl+'plugins/InsertSmiley/smileys/'+'mozilla_cool'+'.png',alt:'8-)',title:this.localize('mozilla_cool')},{file:HTMLArea.editorUrl+'plugins/InsertSmiley/smileys/'+'mozilla_moneyinmouth'+'.png',alt:':-$',title:this.localize('mozilla_moneyinmouth')},{file:HTMLArea.editorUrl+'plugins/InsertSmiley/smileys/'+'mozilla_footinmouth'+'.png',alt:':-!',title:this.localize('mozilla_footinmouth')},{file:HTMLArea.editorUrl+'plugins/InsertSmiley/smileys/'+'mozilla_innocent'+'.png',alt:'O:-)',title:this.localize('mozilla_innocent')},{file:HTMLArea.editorUrl+'plugins/InsertSmiley/smileys/'+'mozilla_cry'+'.png',alt:':\'(',title:this.localize('mozilla_cry')},{file:HTMLArea.editorUrl+'plugins/InsertSmiley/smileys/'+'mozilla_sealed'+'.png',alt:':-X',title:this.localize('mozilla_sealed')}];var pluginInformation={version:'2.0',developer:'Ki Master George & Stanislas Rolland',developerUrl:'http://www.sjbr.ca/',copyrightOwner:'Ki Master George & Stanislas Rolland',sponsor:'Ki Master George & SJBR',sponsorUrl:'http://www.sjbr.ca/',license:'GPL'};this.registerPluginInformation(pluginInformation);var buttonId='InsertSmiley';var buttonConfiguration={id:buttonId,tooltip:this.localize('Insert Smiley'),iconCls:'htmlarea-action-smiley-insert',action:'onButtonPress',hotKey:(this.pageTSConfiguration?this.pageTSConfiguration.hotKey:null),dialog:true};this.registerButton(buttonConfiguration);return true;},onButtonPress:function(editor,id){var buttonId=this.translateHotKey(id);buttonId=buttonId?buttonId:id;var dimensions=this.getWindowDimensions({width:216,height:230},buttonId);this.dialog=new Ext.Window({title:this.localize('Insert Smiley'),cls:'htmlarea-window',border:false,width:dimensions.width,height:'auto',resizable:!Ext.isIE,iconCls:this.getButton(buttonId).iconCls,listeners:{close:{fn:this.onClose,scope:this}},items:{xtype:'box',cls:'emoticon-array',tpl:new Ext.XTemplate('<tpl for="."><a href="#" class="emoticon" hidefocus="on" ext:qtitle="{alt}" ext:qtip="{title}"><img src="{file}" /></a></tpl>'),listeners:{render:{fn:this.render,scope:this}}},buttons:[this.buildButtonConfig('Cancel',this.onCancel)]});this.show();},render:function(component){component.tpl.overwrite(component.el,this.icons);component.mon(component.el,'click',this.insertImageTag,this,{delegate:'a'});},insertImageTag:function(event,target){event.stopEvent();this.editor.focus();this.restoreSelection();var icon=Ext.get(target).first();var imgTag=this.editor.document.createElement('img');imgTag.setAttribute('src',icon.getAttribute('src'));imgTag.setAttribute('alt',target.getAttribute('ext:qtitle'));imgTag.setAttribute('title',target.getAttribute('ext:qtip'));this.editor.insertNodeAtSelection(imgTag);if(!Ext.isIE){this.editor.selectNode(imgTag,false);}
this.close();return false;}});